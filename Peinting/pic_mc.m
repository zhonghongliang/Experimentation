% The Original Data
%pendigits
clear;clc;
T_KBPA0p = [0.0032	0.0028	0.0025	0.0022	0.0022	0.0021	0.0020	0.0022	0.0022	0.0021	0.0022	0.0022	0.0022	0.0025	0.0026	0.0024	0.0023	0.0023	0.0022	0.0024	0.0023	0.0025	0.0022	0.0022	0.0016	0.0025	0.0026	0.0026	0.0024	0.0025	0.0027	0.0026	0.0023	0.0019	0.0024	0.0024	0.0027	0.0027	0.0027	0.0028	0.0029	0.0027	0.0024	0.0028	0.0030	0.0027	0.0025	0.0028	0.0031	0.0028	0.0027	0.0029	0.0032	0.0034	0.0029	0.0032	0.0031	0.0032	0.0022	0.0027	0.0032	0.0034	0.0036	0.0037	0.0033	0.0027	0.0024	0.0031	0.0031	0.0023	0.0031	0.0030	0.0031	0.0032];
R_KBPA0p = [26.96	50.21	71.52	95.09	125.05	147.20	174.92	204.35	228.01	245.01	268.93	292.93	324.67	341.73	365.62	388.67	416.35	439.47	457.39	486.87	506.62	528.07	544.12	566.49	586.35	606.39	630.97	646.35	661.15	683.27	700.21	721.80	737.70	756.56	778.58	795.47	814.23	830.71	848.49	865.97	885.51	902.64	921.74	939.55	958.31	974.60	989.67	1005.18	1017.29	1036.73	1055.20	1075.42	1090.15	1118.73	1133.20	1155.81	1172.97	1183.03	1202.91	1219.59	1236.46	1253.52	1268.31	1286.00	1297.33	1312.27	1320.53	1337.23	1362.85	1374.37	1389.92	1400.81	1415.54	1431.31];
%M_KBPA0p = [0.90	0.66	0.64	0.66	0.63	0.64	0.63	0.61	0.60	0.52	0.46	0.45	0.46	0.45	0.43	0.42	0.43	0.30	0.26	0.28	0.24	0.26	0.19	0.21	0.25	0.28	0.27	0.19	0.22	0.20	0.17	0.21	0.16	0.19	0.19	0.22	0.23	0.22	0.19	0.21	0.20	0.21	0.22	0.19	0.24	0.22	0.23	0.24	0.25	0.24	0.21	0.22	0.21	0.23	0.19	0.23	0.24	0.17	0.20	0.14	0.18	0.21	0.15	0.23	0.16	0.19	0.13	0.17	0.16	0.14	0.16	0.14	0.15	0.14];
M_KBPA0p = [0.900000000000000,0.793333333333333,0.767142857142857,0.746250000000000,0.721111111111111,0.695000000000000,0.650000000000000,0.630000000000000,0.611000000000000,0.588000000000000,0.567000000000000,0.546000000000000,0.513000000000000,0.478000000000000,0.446000000000000,0.418000000000000,0.398000000000000,0.372000000000000,0.347000000000000,0.327000000000000,0.312000000000000,0.297000000000000,0.273000000000000,0.265000000000000,0.259000000000000,0.248000000000000,0.245000000000000,0.235000000000000,0.235000000000000,0.233000000000000,0.230000000000000,0.225000000000000,0.220000000000000,0.220000000000000,0.219000000000000,0.219000000000000,0.223000000000000,0.224000000000000,0.227000000000000,0.232000000000000,0.235000000000000,0.236000000000000,0.237000000000000,0.240000000000000,0.245000000000000,0.245000000000000,0.247000000000000,0.247000000000000,0.248000000000000,0.248000000000000,0.247000000000000,0.249000000000000,0.243000000000000,0.239000000000000,0.228000000000000,0.222000000000000,0.222000000000000,0.215000000000000,0.217000000000000,0.210000000000000,0.210000000000000,0.200000000000000,0.193000000000000,0.192000000000000,0.186000000000000,0.188000000000000,0.184000000000000,0.178000000000000,0.177000000000000,0.171111111111111,0.172500000000000,0.170000000000000,0.176666666666667,0.178000000000000];
CM_KBPA0p = [0, 83,136,183,223,255,287,333,357,382,406,431,451,476,494,517,535,559,576,595,614,633,650,663,679,693,712,735,750,766,780,795,811,832,846,855,863,872,879,891,905,921,932,943,952,967,978,992,1005,1015,1023,1033,1045,1054,1065,1081,1091,1103,1117,1123,1130,1142,1150,1155,1163,1172,1179,1187,1195,1207,1212,1220,1229,1235,1239];


T_KBPALp = [0.0035	0.0056	0.0079	0.0095	0.0099	0.0109	0.0119	0.0127	0.0139	0.0153	0.0159	0.0164	0.0160	0.0166	0.0175	0.0189	0.0216	0.0231	0.0233	0.0227	0.0243	0.0250	0.0270	0.0280	0.0287	0.0280	0.0287	0.0301	0.0319	0.0323	0.0327	0.0342	0.0351	0.0353	0.0370	0.0386	0.0377	0.0395	0.0401	0.0424	0.0445	0.0443	0.0432	0.0432	0.0446	0.0492	0.0492	0.0495	0.0503	0.0491	0.0499	0.0501	0.0507	0.0517	0.0561	0.0537	0.0609	0.0561	0.0604	0.0628	0.0617	0.0636	0.0680	0.0637	0.0651	0.0672	0.0673	0.0649	0.0656	0.0663	0.0696	0.0715	0.0702	0.0718];
R_KBPALp = [85.95	147.86	212.47	271.98	331.47	381.07	432.75	471.31	510.89	542.30	582.28	629.25	666.70	700.84	741.59	786.87	813.13	840.64	878.09	912.81	948.51	992.64	1020.71	1057.35	1085.31	1115.15	1146.31	1179.40	1213.30	1250.32	1282.92	1308.07	1344.97	1376.12	1404.69	1433.48	1464.47	1490.46	1523.16	1556.77	1583.96	1618.28	1643.74	1673.08	1705.56	1737.30	1770.86	1798.97	1826.34	1854.32	1881.76	1911.54	1942.17	1969.78	1999.74	2025.69	2054.36	2081.61	2110.38	2135.62	2170.29	2196.58	2219.44	2245.07	2268.28	2298.74	2323.26	2355.74	2385.59	2416.96	2438.27	2469.12	2492.26	2518.41];
%M_KBPALp = [0.79	0.49	0.47	0.42	0.46	0.37	0.38	0.24	0.22	0.19	0.19	0.15	0.12	0.09	0.12	0.14	0.12	0.13	0.15	0.13	0.14	0.15	0.14	0.11	0.08	0.10	0.12	0.08	0.07	0.08	0.09	0.08	0.07	0.07	0.04	0.03	0.05	0.06	0.04	0.03	0.06	0.06	0.05	0.04	0.06	0.06	0.06	0.05	0.07	0.04	0.04	0.09	0.03	0.04	0.06	0.07	0.04	0.03	0.02	0.01	0.03	0.04	0.03	0.02	0.04	0.03	0.04	0.03	0.05	0.02	0.01	0.01	0.00	0.00];
M_KBPALp=[0.790000000000000,0.563333333333333,0.517142857142857,0.480000000000000,0.447777777777778,0.422000000000000,0.358000000000000,0.321000000000000,0.283000000000000,0.253000000000000,0.221000000000000,0.196000000000000,0.171000000000000,0.162000000000000,0.153000000000000,0.148000000000000,0.144000000000000,0.143000000000000,0.142000000000000,0.141000000000000,0.139000000000000,0.137000000000000,0.133000000000000,0.127000000000000,0.120000000000000,0.116000000000000,0.110000000000000,0.102000000000000,0.0950000000000000,0.0880000000000000,0.0830000000000000,0.0780000000000000,0.0720000000000000,0.0680000000000000,0.0640000000000000,0.0620000000000000,0.0590000000000000,0.0560000000000000,0.0530000000000000,0.0520000000000000,0.0540000000000000,0.0570000000000000,0.0570000000000000,0.0580000000000000,0.0580000000000000,0.0590000000000000,0.0620000000000000,0.0590000000000000,0.0580000000000000,0.0600000000000000,0.0610000000000000,0.0590000000000000,0.0560000000000000,0.0530000000000000,0.0470000000000000,0.0460000000000000,0.0460000000000000,0.0400000000000000,0.0390000000000000,0.0390000000000000,0.0360000000000000,0.0330000000000000,0.0320000000000000,0.0340000000000000,0.0340000000000000,0.0340000000000000,0.0320000000000000,0.0280000000000000,0.0250000000000000,0.0255555555555556,0.0237500000000000,0.0228571428571429,0.0200000000000000,0.0180000000000000];
CM_KBPALp = [0, 80,136,178,212,244,274,309,342,366,386,407,430,451,465,482,502,515,526,543,561,575,592,601,610,616,624,635,642,649,658,666,674,681,688,692,698,707,712,717,721,723,731,736,740,746,751,753,761,773,778,781,791,797,801,807,812,817,822,826,830,833,837,839,844,849,854,859,860,868,870,873,877,880,883];

T_KSGDp = [0.0032	0.0045	0.0057	0.0064	0.0072	0.0077	0.0086	0.0093	0.0099	0.0107	0.0101	0.0105	0.0095	0.0100	0.0106	0.0129	0.0115	0.0119	0.0120	0.0136	0.0123	0.0144	0.0135	0.0133	0.0148	0.0141	0.0145	0.0153	0.0156	0.0163	0.0153	0.0163	0.0161	0.0176	0.0177	0.0181	0.0184	0.0190	0.0187	0.0194	0.0193	0.0200	0.0219	0.0220	0.0225	0.0223	0.0230	0.0238	0.0244	0.0238	0.0255	0.0276	0.0248	0.0254	0.0281	0.0280	0.0267	0.0270	0.0266	0.0268	0.0273	0.0275	0.0280	0.0283	0.0285	0.0289	0.0293	0.0295	0.0301	0.0304	0.0307	0.0307	0.0311	0.0317];
R_KSGDp = [78.99	127.74	176.33	217.25	263.14	307.99	351.82	389.61	428.22	464.96	499.70	530.54	572.40	595.22	628.01	660.73	699.38	738.11	771.96	815.77	841.68	880.33	921.87	954.38	984.82	1015.59	1051.25	1085.02	1119.75	1149.42	1171.36	1202.98	1236.43	1258.89	1286.50	1318.10	1356.73	1392.61	1421.47	1455.12	1490.81	1525.63	1560.28	1598.85	1634.58	1662.29	1687.18	1720.84	1746.72	1785.30	1828.52	1859.35	1889.13	1916.87	1962.34	1992.29	2029.91	2061.62	2097.38	2137.83	2178.49	2207.39	2237.99	2269.90	2305.64	2327.53	2364.21	2394.86	2425.60	2443.46	2474.11	2500.94	2533.85	2569.73];
%M_KSGDp = [0.77	0.36	0.34	0.23	0.25	0.24	0.24	0.14	0.15	0.11	0.12	0.11	0.10	0.12	0.13	0.13	0.14	0.13	0.12	0.14	0.12	0.14	0.12	0.14	0.14	0.12	0.11	0.12	0.11	0.12	0.08	0.09	0.07	0.08	0.10	0.09	0.13	0.11	0.09	0.07	0.10	0.11	0.12	0.11	0.11	0.10	0.10	0.10	0.09	0.08	0.11	0.09	0.10	0.08	0.13	0.13	0.13	0.13	0.10	0.13	0.11	0.09	0.07	0.12	0.12	0.07	0.09	0.08	0.07	0.07	0.08	0.11	0.09	0.11];
M_KSGDp =  [0.770000000000000,0.405000000000000,0.367142857142857,0.340000000000000,0.314444444444444,0.295000000000000,0.229000000000000,0.203000000000000,0.181000000000000,0.171000000000000,0.159000000000000,0.149000000000000,0.138000000000000,0.136000000000000,0.135000000000000,0.136000000000000,0.138000000000000,0.139000000000000,0.143000000000000,0.145000000000000,0.144000000000000,0.142000000000000,0.140000000000000,0.138000000000000,0.138000000000000,0.132000000000000,0.129000000000000,0.122000000000000,0.118000000000000,0.114000000000000,0.109000000000000,0.110000000000000,0.110000000000000,0.107000000000000,0.103000000000000,0.101000000000000,0.104000000000000,0.107000000000000,0.111000000000000,0.114000000000000,0.114000000000000,0.115000000000000,0.112000000000000,0.110000000000000,0.109000000000000,0.113000000000000,0.112000000000000,0.111000000000000,0.107000000000000,0.109000000000000,0.111000000000000,0.114000000000000,0.117000000000000,0.117000000000000,0.121000000000000,0.124000000000000,0.122000000000000,0.120000000000000,0.122000000000000,0.126000000000000,0.120000000000000,0.116000000000000,0.111000000000000,0.105000000000000,0.102000000000000,0.0970000000000000,0.0970000000000000,0.0970000000000000,0.101000000000000,0.0988888888888889,0.0962500000000000,0.100000000000000,0.101666666666667,0.106000000000000];
CM_KSGDp = [0, 56,85,116,140,166,180,204,219,238,252,265,281,297,303,315,328,344,356,367,386,394,408,414,424,433,445,458,466,475,487,495,504,515,530,537,545,561,582,594,597,607,617,629,638,653,674,685,699,713,726,738,747,760,774,789,806,819,841,857,866,878,893,908,921,933,944,957,966,980,991,999,1004,1016,1028];

%Segment
T_KBPA0s = [0.0017	0.0023	0.0021	0.0025	0.0021	0.0018	0.0022	0.0023	0.0019	0.0017	0.0017	0.0018	0.0018	0.0018	0.0017	0.0018	0.0017	0.0018	0.0019	0.0019	0.0019	0.0019	0.0021];
R_KBPA0s = [31.52	60.87	84.42	109.96	140.66	167.37	185.30	205.30	227.10	246.83	274.89	287.31	307.85	329.51	346.10	370.27	388.79	401.85	425.15	443.21	464.86	483.73	505.32];
%M_KBPA0s = [0.76	0.66	0.68	0.65	0.54	0.46	0.36	0.32	0.36	0.30	0.28	0.29	0.31	0.26	0.17	0.24	0.20	0.18	0.23	0.22	0.23	0.21	0.23];
M_KBPA0s=[0.760000000000000,0.685000000000000,0.632857142857143,0.598750000000000,0.565555555555556,0.537000000000000,0.490000000000000,0.455000000000000,0.413000000000000,0.365000000000000,0.335000000000000,0.309000000000000,0.291000000000000,0.282000000000000,0.268000000000000,0.261000000000000,0.254000000000000,0.248000000000000,0.241111111111111,0.238750000000000,0.248571428571429,0.250000000000000,0.260000000000000];
CM_KBPA0s = [0, 70,116,157,194,237,279,313,346,381,400,431,460,483,512,534,567,594,610,643,672,705,729,759];

T_KBPALs = [0.0026	0.0047	0.0056	0.0064	0.0078	0.0082	0.0092	0.0095	0.0101	0.0105	0.0109	0.0111	0.0104	0.0107	0.0106	0.0110	0.0113	0.0113	0.0116	0.0121	0.0124	0.0125	0.0131];
R_KBPALs = [49.39	73.24	94.41	106.15	126.15	140.03	151.22	162.91	175.29	185.77	194.63	202.73	210.29	222.39	228.65	234.54	241.56	250.35	262.54	268.59	273.61	280.22	290.12];
%M_KBPALs = [0.60	0.17	0.16	0.13	0.18	0.16	0.12	0.13	0.12	0.07	0.09	0.04	0.05	0.07	0.05	0.03	0.04	0.06	0.06	0.05	0.06	0.03	0.02];
M_KBPALs = [0.600000000000000,0.253333333333333,0.235714285714286,0.221250000000000,0.204444444444444,0.193000000000000,0.137000000000000,0.125000000000000,0.116000000000000,0.108000000000000,0.0930000000000000,0.0810000000000000,0.0750000000000000,0.0680000000000000,0.0610000000000000,0.0600000000000000,0.0540000000000000,0.0520000000000000,0.0522222222222222,0.0500000000000000,0.0500000000000000,0.0533333333333333,0.0560000000000000];
CM_KBPALs = [0, 63,83,96,105,127,144,156,169,183,190,196,199,203,210,216,220,225,229,236,241,245,252,265];

T_KSGDs = [0.0031	0.0046	0.0050	0.0065	0.0071	0.0072	0.0074	0.0083	0.0090	0.0082	0.0092	0.0087	0.0082	0.0083	0.0089	0.0092	0.0094	0.0093	0.0093	0.0094	0.0100	0.0100	0.0102];
R_KSGDs = [45.74	63.74	79.96	93.09	112.25	126.53	136.67	150.29	158.63	166.91	178.84	185.19	190.89	204.01	209.34	222.16	228.27	235.71	245.27	256.78	268.08	273.75	288.58];
%M_KSGDs = [0.67	    0.32	0.16	0.17	0.20	0.16	0.11	0.11	0.12	0.07	0.09	0.05	0.07	0.08	0.06	0.12	0.09	0.07	0.13	0.11	0.14	0.08	0.11];
M_KSGDs = [0.670000000000000,0.298333333333333,0.271428571428571,0.252500000000000,0.232222222222222,0.218000000000000,0.156000000000000,0.131000000000000,0.123000000000000,0.112000000000000,0.104000000000000,0.0970000000000000,0.0930000000000000,0.0950000000000000,0.0940000000000000,0.101000000000000,0.100000000000000,0.106000000000000,0.110000000000000,0.113750000000000,0.121428571428571,0.121666666666667,0.128000000000000];
CM_KSGDs = [0, 56,87,104,117,138,155,168,180,191,200,212,217,227,236,245,258,271,278,292,302,309,315,337];

n_pen = size(T_KBPA0p,2);
n_seg = size(T_KBPA0s,2);


n = n_seg;
xaxis = [];
for i = 0:n
    xaxis = [xaxis, i*100];
end
%change T to [T, M, R] and p to [p, s]
y1 = CM_KBPA0s;
y2 = CM_KBPALs;
y3 = CM_KSGDs ;
xmax = 2400;
ymax = 800;
values_KBPA0 = [xaxis;y1];
%values_KBPA0 = spcrv([[xaxis(1) xaxis xaxis(end)];[y1(1) y1 y1(end)]],3);
values_KBPAL = [xaxis;y2];
%values_KBPAL = spcrv([[xaxis(1) xaxis xaxis(end)];[y2(1) y2 y2(end)]],3);
values_KSGD  = [xaxis;y3];
%values_KSGD  = spcrv([[xaxis(1) xaxis xaxis(end)];[y3(1) y3 y3(end)]],3);
a = plot(values_KBPA0(1,:),values_KBPA0(2,:), 'g', values_KBPAL(1,:),values_KBPAL(2,:), 'r', values_KSGD (1,:),values_KSGD(2,:), 'b');
%a = plot(values_KBPAL(1,:),values_KBPAL(2,:), 'r', values_KSGD (1,:),values_KSGD(2,:), 'b');
a.set('Markersize',30);
axis([0 xmax 0 ymax])
xtitle = xlabel('Intance number');
ytitle = ylabel('Errors');
option = title('Data Segment');
l = legend(['KBPA(linear)'],['KBPA(Laplace)'],['KSGD']);
xtitle.set('FontSize',18);
ytitle.set('FontSize',18);
option.set('FontSize',18);
l.set('FontSize',18);
%grid on